# 変更履歴 (CHANGELOG)

PTSIアプリケーションの変更履歴を記録します。

## [2.1.0] - 2025-09-25

### 🆕 新機能追加

#### 職員間グループチャット機能
- **新しいファイル**
  - `staff-chat/staff-chat.html` - 職員チャット画面
  - `staff-chat/staff-chat.js` - 職員チャット機能
  - `staff-chat/staff-chat.css` - 職員チャット専用スタイル

- **機能詳細**
  - 5つの専用チャットルーム
    - 全職員チャット (`staff-general`)
    - 担任教師チャット (`staff-teachers`)
    - 管理職チャット (`staff-admin`)
    - サポートスタッフチャット (`staff-support`)
    - 緊急連絡チャット (`staff-emergency`)
  
  - 緊急連絡機能
    - 緊急送信ボタン - 優先度の高いメッセージ
    - 全職員ブロードキャスト - 全ルームに一斉送信
    - 視覚的な緊急表示 - 赤色強調とアニメーション
  
  - オンライン職員表示
    - リアルタイム職員数表示
    - オンライン職員一覧モーダル
    - 部署別職員情報

#### 操作マニュアル機能
- **新しいファイル**
  - `manuals/parent-manual.html` - 保護者向け操作マニュアル
  - `manuals/admin-manual.html` - 運営者向け操作マニュアル

- **機能詳細**
  - ブラウザ印刷機能でPDF生成対応
  - 美しいグラデーションデザイン
  - 印刷専用ヘッダーとボタン
  - レスポンシブ対応

### 🔧 既存機能強化

#### サーバー側 (server.js)
- **新しいAPIエンドポイント**
  - `GET /staff-chat` - 職員チャットページ
  - `POST /staff-chat/send` - 職員メッセージ送信
  - `GET /staff-chat/messages` - 職員メッセージ取得
  - `POST /staff-chat/broadcast` - 緊急ブロードキャスト
  - `POST /api/admin-info` - 管理者情報取得
  - `GET /download/parent-manual` - 保護者マニュアル
  - `GET /download/admin-manual` - 運営者マニュアル

- **データ構造拡張**
  - 職員チャット用メッセージ格納領域追加
  - 管理者情報にdepartment項目追加
  - 職員2名追加（栄養士、事務職員）

#### 管理者ダッシュボード
- **ファイル変更**: `admin-dashboard/admin-dashboard.html`, `admin-dashboard/admin-dashboard.js`
- **機能追加**
  - 「職員チャット」メニュー項目追加
  - 職員チャットページへの遷移機能

#### ログインページ
- **ファイル変更**: `login/login.html`, `admin-login/admin-login.html`
- **機能追加**
  - マニュアルダウンロードボタン
  - 美しいレスポンシブデザイン

### 🎨 UI/UX改善

#### 職員チャット画面
- **デザイン特徴**
  - 職員専用の紫系グラデーション
  - 緊急メッセージの赤色強調表示
  - アニメーション効果（パルス、フラッシュ）
  - ダークモード対応準備

- **アクセシビリティ**
  - キーボード操作対応
  - スクリーンリーダー対応
  - ARIA属性とrole設定

#### マニュアル画面
- **デザイン特徴**
  - 美しいグラデーションヘッダー
  - 印刷最適化CSS
  - レスポンシブデザイン
  - 豊富な絵文字とアイコン

### 📚 ドキュメント更新

#### README.md
- バージョン2.1.0の新機能説明追加
- プロジェクト構造図の更新
- 機能一覧の詳細化

#### 技術仕様書 (TECHNICAL_SPECIFICATION.md)
- 職員チャット機能の詳細仕様追加
- 新しいAPI仕様の記載
- ファイル構成図の更新

### 🔒 セキュリティ

#### 職員チャット
- 管理者Cookie認証必須
- 職員のみアクセス可能
- 緊急送信時の確認ダイアログ

#### マニュアル機能
- HTMLファイル直接提供
- サーバーサイド処理不要
- ブラウザネイティブ印刷機能活用

### 🚀 パフォーマンス

#### 軽量化
- Puppeteerの依存関係削除
- HTMLベース印刷機能
- シンプルなアーキテクチャ

#### メモリ管理
- 職員チャットメッセージ100件制限
- 効率的なメッセージ格納構造

---

## [2.0.0] - 2025-09-24

### 🔄 システム基盤強化
- Node.js v16.14.2 → v24.8.0 アップグレード
- 専用docsフォルダにドキュメント整理
- 技術仕様書の詳細化
- npmスクリプトの追加

### 📝 ドキュメント整備
- 技術仕様書のMarkdown/HTML版作成
- PDF生成ツールの追加
- プロジェクト構造の標準化

---

## [1.0.0] - 初期リリース

### 基本機能
- ログイン機能
- 予約申請機能
- 保護者チャット機能
- データ可視化機能
- 予約確認機能